<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ART CINEMA - AUTOPLAY</title>
    <style>
        :root { --primary: #e50914; --bg: #000; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; }
        
        header { padding: 15px; text-align: center; background: #000; border-bottom: 1px solid #222; position: sticky; top: 0; z-index: 100; }
        .logo { font-size: 22px; font-weight: 900; color: var(--primary); letter-spacing: 2px; }
        
        .search-bar { display: flex; max-width: 400px; margin: 10px auto; gap: 5px; padding: 0 10px; }
        input { flex: 1; padding: 10px; border-radius: 5px; border: 1px solid #333; background: #111; color: white; outline: none; }
        button { background: var(--primary); border: none; color: white; padding: 10px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 10px; padding: 15px; }
        .movie { background: #111; border-radius: 8px; overflow: hidden; border: 1px solid #222; cursor: pointer; transition: 0.2s; }
        .movie:hover { transform: scale(1.05); border-color: var(--primary); }
        .movie img { width: 100%; aspect-ratio: 2/3; object-fit: cover; display: block; }
        .title { padding: 8px; font-size: 10px; text-align: center; font-weight: bold; }

        #player-view { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 10000; }
        iframe { width: 100%; height: 100%; border: none; }
        
        .top-nav { position: absolute; top: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; z-index: 10002; }
        .ui-btn { background: rgba(0,0,0,0.8); color: white; border: 1px solid #444; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 11px; font-weight: bold; }
    </style>
</head>
<body onload="init()">

<div id="player-view">
    <div class="top-nav">
        <button class="ui-btn" onclick="toggleServer()">ðŸ”„ Server <span id="srvNum">1</span></button>
        <button class="ui-btn" style="background:var(--primary); border:none;" onclick="closeP()">âœ• CLOSE</button>
    </div>
    <iframe id="vid-frame" allow="autoplay; fullscreen; encrypted-media" allowfullscreen></iframe>
</div>

<header>
    <div class="logo">ART CINEMA</div>
    <div class="search-bar">
        <input type="text" id="q" placeholder="Search..." onkeyup="if(event.key==='Enter')doSearch()">
        <button onclick="doSearch()">GO</button>
    </div>
</header>

<div class="grid" id="container"></div>

<script>
    const API = "6bb2ab3d2da16b9f65c3af2b9ac1fcad";
    let activeId = "", activeType = "", srv = 0;

    async function init() {
        const r = await fetch(`https://api.themoviedb.org/3/trending/all/week?api_key=${API}`);
        const d = await r.json();
        render(d.results);
    }

    async function doSearch() {
        const q = document.getElementById('q').value;
        if(!q) return;
        const r = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API}&query=${encodeURIComponent(q)}`);
        const d = await r.json();
        render(d.results);
    }

    function render(data) {
        const c = document.getElementById('container'); c.innerHTML = "";
        data.forEach(m => {
            if(!m.poster_path) return;
            const div = document.createElement('div');
            div.className = 'movie';
            // User clicks here -> Browser grants permission to autoplay video
            div.onclick = () => { activeId = m.id; activeType = m.media_type || (m.title ? 'movie' : 'tv'); startAutoplay(); };
            div.innerHTML = `<img src="https://image.tmdb.org/t/p/w200${m.poster_path}"><div class="title">${m.title || m.name}</div>`;
            c.appendChild(div);
        });
    }

    function startAutoplay() {
        srv = 0;
        document.getElementById('srvNum').innerText = "1";
        document.getElementById('player-view').style.display = 'block';
        loadSource();
    }

    function loadSource() {
        const frame = document.getElementById('vid-frame');
        
        // Added &autoplay=1 to the sources that support it
        const urls = [
            `https://vidsrc.to/embed/${activeType}/${activeId}?autoplay=1`,
            `https://vidsrc.me/embed/${activeType}?tmdb=${activeId}&autoplay=1`,
            `https://embed.su/embed/${activeType}/${activeId}?autoplay=1`
        ];
        
        frame.src = urls[srv];
    }

    function toggleServer() {
        srv = (srv + 1) % 3;
        document.getElementById('srvNum').innerText = srv + 1;
        loadSource();
    }

    function closeP() {
        document.getElementById('vid-frame').src = "";
        document.getElementById('player-view').style.display = 'none';
    }
</script>
</body>
</html>
